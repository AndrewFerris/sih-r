}
styles
brewer.pal(length(nodes$ID), name = "BrBG")[1]
styles <- NULL
for(i in 1:length(a)){
styles[i] <- list(styles$nodes$ID[i] <- list(col = brewer.pal(length(nodes$ID), name = "BrBG")[i],
lty = 0,
textcol = "black"))
}
styles
styles <- NULL
for(i in 1:length(a)){
styles[i] <- styles$nodes$ID[i]
}
styles
styles <- NULL
for(i in 1:length(a)){
styles[i] <- list(styles$nodes$ID[i])
}
styles
styles <- NULL
for(i in 1:length(a)){
styles$[i] <- list(nodes$ID[i])
}
styles
styles <- NULL
for(i in 1:length(a)){
styles$nodes$ID[i] <- list(col = brewer.pal(length(nodes$ID), name = "BrBG")[i],
lty = 0,
textcol = "black")
}
styles
styles= list(
A=list(
col=  "#00990099",
lty=0,
textcol= "white"
),
H=list(
col= "#FF000099",
textcol= "white"
),
B= list( col= "#00006699", textcol= "white" ),
F= list( col= "yellow" ),
D= list( col= "#00FF0099" )
)
styles
styles <- list(nodes$ID)
styles
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep("black", length(nodes$ID))))
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
View(styles)
names(styles) <- c("ID", "col", "lty", "textcol")
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
View(styles)
table_rp <- function(table = table){
#load the required packages
library(gdata, quietly = TRUE)
library(riverplot, quietly = TRUE)
library(dplyr, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
#create the edges object
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
#create the nodes objects
ID = NULL
x = NULL
y = NULL
for(i in 2:ncol(data) - 1){
ID <- c(ID, unique(data[,i]))
x <- c(x, rep(i, length(unique(data[,i]))))
y <- c(y, seq(1, length(unique(data[,i]))))
}
nodes <- data.frame(ID, x, y, stringsAsFactors = F)
rownames(nodes) = nodes$ID
#create the styles object
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
#create the riverplot objects
rp <- list(nodes = nodes, edges = edges, styles = styles)
class(rp) <- c(class(rp), "riverplot")
#plot object
plot(rp)
r_list <- list(nodes = nodes, edges = edges, styles = styles)
return(r_list)
}
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
temp <- table_rp(data)
table_rp <- function(table = table){
#load the required packages
library(gdata, quietly = TRUE)
library(riverplot, quietly = TRUE)
library(dplyr, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
#create the edges object
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
#create the nodes objects
ID = NULL
x = NULL
y = NULL
for(i in 2:ncol(data) - 1){
ID <- c(ID, unique(data[,i]))
x <- c(x, rep(i, length(unique(data[,i]))))
y <- c(y, seq(1, length(unique(data[,i]))))
}
nodes <- data.frame(ID, x, y, stringsAsFactors = F)
rownames(nodes) = nodes$ID
#create the styles object
styles <- NULL
for(i in 1:length(nodes$ID)){
styles[[i]] <- nodes$ID[i]
styles[[i]][1] <- brewer.pal(length(nodes$ID)[i], name = "BrBG")
}
#create the riverplot objects
rp <- list(nodes = nodes, edges = edges, styles = styles)
class(rp) <- c(class(rp), "riverplot")
#plot object
plot(rp)
r_list <- list(nodes = nodes, edges = edges, styles = styles)
return(r_list)
}
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
temp <- table_rp(data)
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
View(styles)
slist <- list(styles[,1] <- list(col = styles[,2], lty = styles[,3], textcol = styles[,4]))
slist
slist <- NULL
for(i in 1:nrow(styles)){
slist <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(slist[i] = styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list((slist[i] = styles[i,1]) <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
slist
names(slist) <- styles[i,1]
slist
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
names(slist) <- styles[,1]
slist
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles$ID <- list(col = styles$col, lty = styles$lty, textcol = styles$textcol))
}
names(slist) <- styles$ID
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(styles[i,1] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4]))
}
names(slist) <- styles$ID
slist
View(styles)
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
test_styles= list(
A=list(
col=  "#00990099",
lty=0,
textcol= "white"
),
H=list(
col= "#FF000099",
textcol= "white"
),
B= list( col= "#00006699", textcol= "white" ),
F= list( col= "yellow" ),
D= list( col= "#00FF0099" )
)
test_styles
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
table_rp <- function(table = table){
#load the required packages
library(gdata, quietly = TRUE)
library(riverplot, quietly = TRUE)
library(dplyr, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
#create the edges object
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
#create the nodes objects
ID = NULL
x = NULL
y = NULL
for(i in 2:ncol(data) - 1){
ID <- c(ID, unique(data[,i]))
x <- c(x, rep(i, length(unique(data[,i]))))
y <- c(y, seq(1, length(unique(data[,i]))))
}
nodes <- data.frame(ID, x, y, stringsAsFactors = F)
rownames(nodes) = nodes$ID
#create the styles object
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
#create the riverplot objects
rp <- list(nodes = nodes, edges = edges, styles = slist)
class(rp) <- c(class(rp), "riverplot")
#plot object
plot(rp)
r_list <- list(nodes = nodes, edges = edges, styles = styles)
return(r_list)
}
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
temp <- table_rp(data)
table_rp <- function(table = table){
#load the required packages
library(gdata, quietly = TRUE)
library(riverplot, quietly = TRUE)
library(dplyr, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
#create the edges object
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
#create the nodes objects
ID = NULL
x = NULL
y = NULL
for(i in 2:ncol(data) - 1){
ID <- c(ID, unique(data[,i]))
x <- c(x, rep(i, length(unique(data[,i]))))
y <- c(y, seq(1, length(unique(data[,i]))))
}
nodes <- data.frame(ID, x, y, stringsAsFactors = F)
rownames(nodes) = nodes$ID
#create the styles object
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
#create the riverplot objects
rp <- list(nodes = nodes, edges = edges)
class(rp) <- c(class(rp), "riverplot")
#plot object
plot(rp)
r_list <- list(nodes = nodes, edges = edges)
return(r_list)
}
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
temp <- table_rp(data)
View(nodes)
View(data)
temp$edges
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
data <- table
table <- data
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
table <- data
obj <- unique(t(apply(table[,1:ncol(table) - 1], 1, sort)))
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
obj
N1
N2
Value
obj <- table[,1:ncol(table) - 1]
obj
N1
N2
Value
obj <- table[,1:ncol(table) - 1]
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
obj
N1
N2
Value
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
edges
table_rp <- function(table = table){
#load the required packages
library(gdata, quietly = TRUE)
library(riverplot, quietly = TRUE)
library(dplyr, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
#create the edges object
obj <- table[,1:ncol(table) - 1]
N1 <- unmatrix(obj[,c(1:ncol(obj) - 1)])
N2 <- unmatrix(obj[,c(2:ncol(obj))])
Value <- rep(table[,c(ncol(table))], ncol(obj) - 1)
edges <- data.frame(N1, N2, Value, stringsAsFactors = F)
row.names(edges) <- NULL
edges <- as.data.frame(edges %>%
group_by(N1, N2) %>%
summarise(Value = sum(as.integer(Value))))
#create the nodes objects
ID = NULL
x = NULL
y = NULL
for(i in 2:ncol(data) - 1){
ID <- c(ID, unique(data[,i]))
x <- c(x, rep(i, length(unique(data[,i]))))
y <- c(y, seq(1, length(unique(data[,i]))))
}
nodes <- data.frame(ID, x, y, stringsAsFactors = F)
rownames(nodes) = nodes$ID
#create the styles object
styles <- data.frame(c(nodes$ID),
c(brewer.pal(length(nodes$ID), name = "BrBG")),
c(rep(0, length(nodes$ID))),
c(rep("black", length(nodes$ID))),
stringsAsFactors = F)
names(styles) <- c("ID", "col", "lty", "textcol")
slist <- NULL
for(i in 1:nrow(styles)){
slist[i] <- list(col = styles[i,2], lty = styles[i,3], textcol = styles[i,4])
}
names(slist) <- styles$ID
slist
#create the riverplot objects
rp <- list(nodes = nodes, edges = edges)
class(rp) <- c(class(rp), "riverplot")
#plot object
plot(rp)
r_list <- list(nodes = nodes, edges = edges)
return(r_list)
}
data <- data.frame(c("A1", "A1", "A1", "B1", "C1"),
c("A2", "C2", "C2", "A2", "B2"),
c("C3", "C3", "A3", "A3", "A3"),
c("C4", "C4", "A4", "B4", "C4"),
c(1,2,3,4,5),
stringsAsFactors = F)
row.names(data) <- c("R1", "R2", "R3", "R4", "R5")
colnames(data) <- c("Col1", "Col2", "Col3", "Col4", "Col5")
data <- as.matrix(data)
temp <- table_rp(data)
